#!/bin/sh
# shellcheck disable=SC2015,SC2166
LANG=C # incase someone tries to use grep on a binary

rcase() {
  while read -r p || [ -n "$p" ] ; do
    case "$p" in
      *${1}*)
        [ "$2" != "-q" ] && { printf "%s\\n" "$p"; } || { exit 0; }
      ;;
    esac    
  done <&0
  exit 1
}
case "$#" in
  0) exit 1;;
  1) rcase "$1";;
  2)
    [ -e "$2" ] && { rcase "$1" < "$2"; } || { 
      rcase "$1" "-q"
    };;
  3)
    [ -e "$2" -a "$3" = "-q" ] && { rcase "$1" "-q" < "$2"; } || {
      exit 1
    };;
esac
